"use strict";(globalThis.webpackChunkglados_documentation=globalThis.webpackChunkglados_documentation||[]).push([[822],{879:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>d,frontMatter:()=>o,metadata:()=>i,toc:()=>h});const i=JSON.parse('{"id":"Ai","title":"The Brain: Oracle & Investigator","description":"To understand how our AI works, imagine it as a Duo of Detectives trying to solve a case (win the game) within a strict time limit (5 seconds).","source":"@site/docs/Ai.md","sourceDirName":".","slug":"/Ai","permalink":"/gomoku/docs/Ai","draft":false,"unlisted":false,"editUrl":"https://github.com/yanisdolivet/gomoku/tree/main/documentation/docs/Ai.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"id":"Ai","title":"The Brain: Oracle & Investigator","sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Introduction","permalink":"/gomoku/docs/Introduction"},"next":{"title":"Advanced Code Optimisation","permalink":"/gomoku/docs/Optimisation"}}');var s=t(4848),r=t(8453);const o={id:"Ai",title:"The Brain: Oracle & Investigator",sidebar_position:2},l="The Brain: A Detective Duo",a={},h=[{value:"Part 1: The Oracle (The Neural Network)",id:"part-1-the-oracle-the-neural-network",level:2},{value:"1. The Input (What it sees)",id:"1-the-input-what-it-sees",level:3},{value:"2. The Processing (The Filters)",id:"2-the-processing-the-filters",level:3},{value:"3. The Output (The Prophecy)",id:"3-the-output-the-prophecy",level:3},{value:"Part 2: The Investigator (MCTS)",id:"part-2-the-investigator-mcts",level:2},{value:"Step 1: Selection (Choosing the Path)",id:"step-1-selection-choosing-the-path",level:3},{value:"Step 2: Expansion (Opening a Door)",id:"step-2-expansion-opening-a-door",level:3},{value:"Step 3: Evaluation (Calling the Oracle)",id:"step-3-evaluation-calling-the-oracle",level:3},{value:"Step 4: Backpropagation (The Report)",id:"step-4-backpropagation-the-report",level:3},{value:"Synthesis: The Perfect Symbiosis",id:"synthesis-the-perfect-symbiosis",level:2},{value:"Concrete Example on the Board",id:"concrete-example-on-the-board",level:3},{value:"Technical Challenge (Code Implementation)",id:"technical-challenge-code-implementation",level:2}];function c(e){const n={blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"the-brain-a-detective-duo",children:"The Brain: A Detective Duo"})}),"\n",(0,s.jsxs)(n.p,{children:["To understand how our AI works, imagine it as a ",(0,s.jsx)(n.strong,{children:"Duo of Detectives"})," trying to solve a case (win the game) within a strict time limit (5 seconds)."]}),"\n",(0,s.jsx)(n.p,{children:"This duo consists of two very different entities working hand in hand:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"The Oracle (Neural Network)"}),": Has brilliant intuition but is lazy. Looking at a crime scene (the board), it instantly says: ",(0,s.jsx)(n.em,{children:'"I think it\'s Colonel Mustard!"'})," But it doesn't check the evidence."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"The Investigator (MCTS)"}),": Is methodical and obsessive. It takes the leads given by the Oracle and physically verifies if they hold up by simulating the future."]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"part-1-the-oracle-the-neural-network",children:"Part 1: The Oracle (The Neural Network)"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Role: Pure Intuition."})}),"\n",(0,s.jsx)(n.p,{children:"Don't think of the neural network as a complete brain, but rather as a pair of ultra-sophisticated eyes connected to a reflex."}),"\n",(0,s.jsx)(n.h3,{id:"1-the-input-what-it-sees",children:"1. The Input (What it sees)"}),"\n",(0,s.jsx)(n.p,{children:'We give it a "photo" of the board. But instead of colored pixels, it sees our Bitboard ($20 \\times 20$):'}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Layer 1"}),": Where are my stones? (1 or 0)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Layer 2"}),": Where are the opponent's stones?"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Layer 3"}),": History (Last move played)."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"2-the-processing-the-filters",children:"2. The Processing (The Filters)"}),"\n",(0,s.jsx)(n.p,{children:'The image passes through layers of "filters" (Convolution).\nImagine placing small $3 \\times 3$ stencils over the board to look for specific patterns:'}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.em,{children:"Filter 1"}),' looks for "3 aligned stones".']}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.em,{children:"Filter 2"}),' looks for "a blocked diagonal".']}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.em,{children:"Filter 3"}),' looks for "a broken L-shape".']}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["By stacking these layers, the network no longer sees stones; it sees tactical concepts (",(0,s.jsx)(n.em,{children:'"Danger top-right"'}),", ",(0,s.jsx)(n.em,{children:'"Opportunity in center"'}),")."]}),"\n",(0,s.jsx)(n.h3,{id:"3-the-output-the-prophecy",children:"3. The Output (The Prophecy)"}),"\n",(0,s.jsx)(n.p,{children:"At the end, the Oracle spits out two crucial pieces of information:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"The Policy ($P$ - Heatmap)"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:'It doesn\'t tell us "Play at 10,10".'}),"\n",(0,s.jsxs)(n.li,{children:["It tells us: ",(0,s.jsx)(n.em,{children:'"I have a very good feeling about 10,10 (80%), a doubt about 9,9 (15%), and the rest is trash (5%)."'})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Analogy"}),": ",(0,s.jsx)(n.em,{children:'"I bet the culprit is in this room."'})]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"The Value ($V$ - Prediction)"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"A single number between -1 (Lost) and +1 (Won)."}),"\n",(0,s.jsxs)(n.li,{children:["It tells us: ",(0,s.jsx)(n.em,{children:'"Given the current board, I am 90% confident we will win in the end."'})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"part-2-the-investigator-mcts",children:"Part 2: The Investigator (MCTS)"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Role: Verification by Simulation."})}),"\n",(0,s.jsxs)(n.p,{children:["If we followed the Oracle blindly, we would make stupid mistakes (blunders) because it sometimes misses obvious things. The Investigator (",(0,s.jsx)(n.strong,{children:"MCTS"})," - Monte Carlo Tree Search) takes the Oracle's predictions and builds a ",(0,s.jsx)(n.strong,{children:"Tree of Possibilities"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"It runs in a loop during your 5 seconds. Here is what it does at every iteration (one iteration = a few microseconds):"}),"\n",(0,s.jsx)(n.h3,{id:"step-1-selection-choosing-the-path",children:"Step 1: Selection (Choosing the Path)"}),"\n",(0,s.jsxs)(n.p,{children:["We start at the root (current board). We must descend into the tree until we reach a leaf (a future we haven't explored yet). How to choose the path? We use a magic formula (",(0,s.jsx)(n.strong,{children:"PUCT"}),") that balances two conflicting desires:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Greed (Exploitation)"}),": ",(0,s.jsx)(n.em,{children:'"The Oracle said this move was great, and my previous simulations confirm we usually win down this path. Let\'s go there again."'})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Curiosity (Exploration)"}),": ",(0,s.jsx)(n.em,{children:"\"We've never looked at this move, and the Oracle said it wasn't bad. Let's check it out, just in case.\""})]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"step-2-expansion-opening-a-door",children:"Step 2: Expansion (Opening a Door)"}),"\n",(0,s.jsx)(n.p,{children:"We reach the end of a known path. We play one more move. We create a new Node."}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:'"Okay, if we play here, the board looks like this."'})}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"step-3-evaluation-calling-the-oracle",children:"Step 3: Evaluation (Calling the Oracle)"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"This is THE difference from classic MCTS."})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.em,{children:"Before (Classic)"}),": We played randomly until the end of the game (thousands of moves) to see who won. Too slow and inaccurate for Gomoku."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Now (AlphaZero)"}),": We stop immediately. We show the new board to the Oracle.","\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Oracle"}),": ",(0,s.jsx)(n.em,{children:'"Hmm, in this position, I think you have a 60% chance of winning ($V=0.6$)."'})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"step-4-backpropagation-the-report",children:"Step 4: Backpropagation (The Report)"}),"\n",(0,s.jsx)(n.p,{children:"The Investigator climbs back up the entire path to the root. It updates every node it passed through:"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:'"Hey guys! I explored this branch, and the Oracle says it smells good (0.6). Increase the average score of this path!"'})}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"synthesis-the-perfect-symbiosis",children:"Synthesis: The Perfect Symbiosis"}),"\n",(0,s.jsx)(n.p,{children:"Why is this method unbeatable?"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"The Oracle saves time"}),': Thanks to it, MCTS doesn\'t waste time exploring stupid moves (like playing in an empty corner at the start). It focuses only on moves the Oracle deems "interesting".']}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"The MCTS corrects the Oracle"}),": Sometimes the Oracle is wrong (",(0,s.jsx)(n.em,{children:'"Looks winning..."'}),"). But by descending the tree, MCTS realizes that 3 moves later, we lose. It effectively lowers the score of that move, even if the Oracle liked it initially."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"concrete-example-on-the-board",children:"Concrete Example on the Board"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Situation"}),": The opponent has 3 aligned stones."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Oracle ($P$)"}),": Sees the pattern. Screams: ",(0,s.jsx)(n.em,{children:'"Block here! 99% Probability!"'})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"MCTS"}),":","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Looks at the Oracle's suggestion."}),"\n",(0,s.jsx)(n.li,{children:"Simulates the block."}),"\n",(0,s.jsxs)(n.li,{children:["Asks the Oracle about the position ",(0,s.jsx)(n.em,{children:"after"})," the block."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Oracle ($V$)"}),": ",(0,s.jsx)(n.em,{children:'"Now it\'s safe. Value +0.1."'})]}),"\n",(0,s.jsxs)(n.li,{children:["MCTS reports back: ",(0,s.jsx)(n.em,{children:'"Blocking is a good move."'})]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Result"}),': After 1000 simulations, the move "Block" was visited 990 times. Your bot plays this move.']}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"technical-challenge-code-implementation",children:"Technical Challenge (Code Implementation)"}),"\n",(0,s.jsx)(n.p,{children:"Since ML libraries are forbidden in the C++ engine:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Matrix Mathematics"}),": The Oracle is just a massive matrix multiplication. We coded ",(0,s.jsx)(n.code,{children:"Matrix * Matrix"})," in optimized C++ (AVX/SIMD)."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Weight Loading"}),': The Oracle needs to "know" (the learned filters). We train them in Python, save them to a ',(0,s.jsx)(n.code,{children:".bin"})," file, and the C++ engine loads them into ",(0,s.jsx)(n.code,{children:"float[]"})," arrays at startup."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"The Tree"}),": A lightweight pointer structure (",(0,s.jsx)(n.code,{children:"Node*"}),") designed to not explode the RAM."]}),"\n"]})]})}function d(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>l});var i=t(6540);const s={},r=i.createContext(s);function o(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);